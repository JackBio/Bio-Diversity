axis.ticks = element_line(size = 1),
panel.grid.major = element_line(size = 1,linetype = "blank"),
panel.grid.minor = element_line(size = 1,linetype = "blank"),
axis.title = element_text(size = 20),
axis.text.x = element_text(size = 17),
axis.text.y = element_text(size = 17),
panel.background = element_rect(size = 0.5),#size=0，右半内框消失，很丑
plot.background = element_rect(size = 1, colour = 'white'),
legend.key = element_rect(fill = NA),
legend.text = element_text(size = 17),
legend.title = element_text(size = 20),
plot.title = element_text(size = 25,
hjust = -0.09, vjust = 0.27)) +
labs(fill = 12, size = 17) +
labs(title = "b")
#library(ggThemeAssist)
#library(esquisse)
dab <- ggplot(data = alldab, mapping = aes(x = years, y = logcontent, colour = location)) +
geom_point(aes(shape=location),size = 5) + #geom_tile(aes(fill=location)) + #scale_colour_brewer(alldab$location) +
geom_smooth(stat = 'smooth', method="loess", se = FALSE, formula = 'y ~x', aes(shape=location)) +  #拟合区间关闭, method = lm这是直线)
theme(panel.background = element_rect(colour = "black",linetype = "solid"))+ #,  #内框实心
#plot.background = element_rect(colour = "black"), #外框出现
#plot.title = element_text(hjust = 0.5)) + #标题居中hjust和vjust
#labs(title = "Trend of 10-dab content in two regions with year") + #该期刊子图不要标题
theme(plot.subtitle = element_text(colour = "gray34"),
panel.background = element_rect(fill = NA),
legend.key = element_rect(fill = "white", colour = "white"),
legend.background = element_rect(fill = NA))
dab + theme(axis.line = element_line(colour = "gray20"),
axis.ticks = element_line(size = 1),
panel.grid.major = element_line(size = 1,linetype = "blank"),
panel.grid.minor = element_line(size = 1,linetype = "blank"),
axis.title = element_text(size = 20),
axis.text.x = element_text(size = 17),
axis.text.y = element_text(size = 17),
panel.background = element_rect(size = 0.5),#size=0，右半内框消失，很丑
plot.background = element_rect(size = 1, colour = 'white'),
legend.key = element_rect(fill = NA),
legend.text = element_text(size = 17),
legend.title = element_text(size = 20),
plot.title = element_text(size = 25,
hjust = -0.09, vjust = 0.27)) +
labs(fill = 12, size = 17) +
labs(title = "b")
#library(ggThemeAssist)
#library(esquisse)
dab <- ggplot(data = alldab, mapping = aes(x = years, y = logcontent, colour = location)) +
geom_point(size = 3) + #geom_tile(aes(fill=location)) + #scale_colour_brewer(alldab$location) +
geom_smooth(stat = 'smooth', method="loess", se = FALSE, formula = 'y ~x', aes(shape=location)) +  #拟合区间关闭, method = lm这是直线)
theme(panel.background = element_rect(colour = "black",linetype = "solid"))+ #,  #内框实心
#plot.background = element_rect(colour = "black"), #外框出现
#plot.title = element_text(hjust = 0.5)) + #标题居中hjust和vjust
#labs(title = "Trend of 10-dab content in two regions with year") + #该期刊子图不要标题
theme(plot.subtitle = element_text(colour = "gray34"),
panel.background = element_rect(fill = NA),
legend.key = element_rect(fill = "white", colour = "white"),
legend.background = element_rect(fill = NA))
dab + theme(axis.line = element_line(colour = "gray20"),
axis.ticks = element_line(size = 1),
panel.grid.major = element_line(size = 1,linetype = "blank"),
panel.grid.minor = element_line(size = 1,linetype = "blank"),
axis.title = element_text(size = 20),
axis.text.x = element_text(size = 17),
axis.text.y = element_text(size = 17),
panel.background = element_rect(size = 0.5),#size=0，右半内框消失，很丑
plot.background = element_rect(size = 1, colour = 'white'),
legend.key = element_rect(fill = NA),
legend.text = element_text(size = 17),
legend.title = element_text(size = 20),
plot.title = element_text(size = 25,
hjust = -0.09, vjust = 0.27)) +
labs(fill = 12, size = 17) +
labs(title = "b")
#library(ggThemeAssist)
#library(esquisse)
dab <- ggplot(data = alldab, mapping = aes(x = years, y = logcontent, colour = location)) +
geom_point(aes(shape=location),size = 3) + #geom_tile(aes(fill=location)) + #scale_colour_brewer(alldab$location) +
geom_smooth(stat = 'smooth', method="loess", se = FALSE, formula = 'y ~x') +  #拟合区间关闭, method = lm这是直线)
theme(panel.background = element_rect(colour = "black",linetype = "solid"))+ #,  #内框实心
#plot.background = element_rect(colour = "black"), #外框出现
#plot.title = element_text(hjust = 0.5)) + #标题居中hjust和vjust
#labs(title = "Trend of 10-dab content in two regions with year") + #该期刊子图不要标题
theme(plot.subtitle = element_text(colour = "gray34"),
panel.background = element_rect(fill = NA),
legend.key = element_rect(fill = "white", colour = "white"),
legend.background = element_rect(fill = NA))
dab + theme(axis.line = element_line(colour = "gray20"),
axis.ticks = element_line(size = 1),
panel.grid.major = element_line(size = 1,linetype = "blank"),
panel.grid.minor = element_line(size = 1,linetype = "blank"),
axis.title = element_text(size = 20),
axis.text.x = element_text(size = 17),
axis.text.y = element_text(size = 17),
panel.background = element_rect(size = 0.5),#size=0，右半内框消失，很丑
plot.background = element_rect(size = 1, colour = 'white'),
legend.key = element_rect(fill = NA),
legend.text = element_text(size = 17),
legend.title = element_text(size = 20),
plot.title = element_text(size = 25,
hjust = -0.09, vjust = 0.27)) +
labs(fill = 12, size = 17) +
labs(title = "b")
ggsave('趋势预测.pdf',dpi = 600, width = 7, height = 3)
#配上p检验*标志的装逼图
pdf('cor.pdf',width = 7,height = 7)
corrplot.mixed(co2$r, p.mat = co2$P, #确定数据源
insig = "label_sig", sig.level = c(.001, .01, .05), pch.cex = 1.0, pch.col = "red",#添加p标注信息
upper = 'ellipse', lower.col = 'black', number.cex= .6,#设置上半部
tl.col='blue', tl.pos = 'd', tl.cex = .9,#设置标签，lt左+上，d对角线，n无
cl.pos = 'r',#色条位置，r右b下n无
title(' ', hjust = -0.1, vjust = 0.5))#无效，这函数和ggplot不联通
#addshade = 'positive',
#title = " ") #设置大标题，P里有NA报错，不知道怎么解决，选择无视
dev.off()
#配上p检验*标志的装逼图
pdf('cor.pdf',width = 7,height = 7)
corrplot.mixed(co2$r, p.mat = co2$P, #确定数据源
insig = "label_sig", sig.level = c(.001, .01, .05), pch.cex = 1.2, pch.col = "red",#添加p标注信息
upper = 'ellipse', lower.col = 'black', number.cex= .6,#设置上半部
tl.col='blue', tl.pos = 'd', tl.cex = 1,#设置标签，lt左+上，d对角线，n无
cl.pos = 'r',#色条位置，r右b下n无
title(' ', hjust = -0.1, vjust = 0.5))#无效，这函数和ggplot不联通
#addshade = 'positive',
#title = " ") #设置大标题，P里有NA报错，不知道怎么解决，选择无视
dev.off()
#配上p检验*标志的装逼图
pdf('cor.pdf',width = 7,height = 7)
corrplot.mixed(co2$r, p.mat = co2$P, #确定数据源
insig = "label_sig", sig.level = c(.001, .01, .05), pch.cex = 1.2, pch.col = "red",#添加p标注信息
upper = 'ellipse', lower.col = 'black', number.cex= .6,#设置上半部
tl.col='blue', tl.pos = 'd', tl.cex = 1.2,#设置标签，lt左+上，d对角线，n无
cl.pos = 'r',#色条位置，r右b下n无
title(' ', hjust = -0.1, vjust = 0.5))#无效，这函数和ggplot不联通
#addshade = 'positive',
#title = " ") #设置大标题，P里有NA报错，不知道怎么解决，选择无视
dev.off()
#配上p检验*标志的装逼图
pdf('cor.pdf',width = 7,height = 7)
#进阶
corrplot(co2$r, p.mat = co2$P, method = c('ellipse'), type = c('upper'), insig = "label_sig", sig.level = c(.001, .01, .05), pch.cex = 1.5, pch.col = "red", tl.col='blue')
#addshade = 'positive',
#title = " ") #设置大标题，P里有NA报错，不知道怎么解决，选择无视
dev.off()
#进阶
corrplot(co2$r, p.mat = co2$P, method = c('circle'), type = c('upper'), insig = "label_sig", sig.level = c(.001, .01, .05), pch.cex = 1.5, pch.col = "red", tl.col='blue', tl.cex = 1.5)
#配上p检验*标志的装逼图
pdf('cor.pdf',width = 7,height = 7)
#进阶
corrplot(co2$r, p.mat = co2$P, method = c('ellipse'), type = c('upper'), insig = "label_sig", sig.level = c(.001, .01, .05), pch.cex = 1.5, pch.col = "red", tl.col='blue', tl.cex = 1.5)
#addshade = 'positive',
#title = " ") #设置大标题，P里有NA报错，不知道怎么解决，选择无视
dev.off()
p.com = ggplot(data = t_b, aes(x = ids, y = val, col = ids)) +
geom_boxplot() +
theme(panel.background = element_rect(fill = "gray100"),
legend.key = element_rect(fill = "gray100"),
legend.background = element_rect(fill = NA),
legend.text = element_text(size = 17),
axis.title = element_text(size = 20),
axis.text.x = element_text(size = 17, colour = 'black'),
axis.text.y = element_text(size = 17),
plot.title = element_text(size = 25,
hjust = -0.17, vjust = 0.27)) +
labs(title = "a", y = "val µg/g", x = 'Groups')+
#ggtitle(label = 'A') + #本图用title也可以达成编号的目标，但位置不够左上
#annotate("text", x = 1, y = 800, label = "A", colour = 'black', size = 5) + #图编号,也可以geom_text(),但位置不太好弄
annotate("text", x = c(1,2,3,4,5,6), y = 800, label = c("a","a","ab","ab","ab","b"), colour = 'black', size = 7.5) #+ #去tt里看p,用字母标记法
p.com
p.com
View(tt)
tt[["p.value"]]
bt = kwAllPairsNemenyiTest(val ~ ids, data = b, dist = "Chisq")
b <- hplc[31:60,15:16]
bt = kwAllPairsNemenyiTest(val ~ ids, data = b, dist = "Chisq")
bt[['p.value']]
bk <- ggplot(data = b, aes(x = ids, y = val, col = ids)) + geom_boxplot()
bk + theme(panel.background = element_rect(fill = "gray100"),
legend.key = element_rect(fill = "gray100"),
legend.background = element_rect(fill = NA),
legend.text = element_text(size = 17),
axis.title = element_text(size = 20),
axis.text.x = element_text(size = 17, colour = 'black'),
axis.text.y = element_text(size = 17),
plot.title = element_text(size = 25,
hjust = -0.17, vjust = 0.27)) + labs(y = "val µg/g", x = 'Groups')+
annotate("text", x = c(1,2,3,4,5,6), y = 800, label = c("a","a","ab","ab","ab","b"), colour = 'black', size = 7.5)
annotate("text", x = c(1,2,3,4,5,6), y = 200, label = c("a","a","ab","ab","ab","b"), colour = 'black', size = 7.5)
######借鉴后文(正文图先出)######
bk + theme(panel.background = element_rect(fill = "gray100"),
+            legend.key = element_rect(fill = "gray100"),
+            legend.background = element_rect(fill = NA),
+            legend.text = element_text(size = 17),
+            axis.title = element_text(size = 20),
+            axis.text.x = element_text(size = 17, colour = 'black'),
+            axis.text.y = element_text(size = 17),
+            plot.title = element_text(size = 25,
+            hjust = -0.17, vjust = 0.27)) +
labs(y = "val µg/g", x = 'Groups')+
annotate("text", x = c(1,2,3,4,5,6), y = 200, label = c("a","a","ab","ab","ab","b"), colour = 'black', size = 7.5)
######借鉴后文(正文图先出)######
bk + theme(panel.background = element_rect(fill = "gray100"),
legend.key = element_rect(fill = "gray100"),
legend.background = element_rect(fill = NA),
legend.text = element_text(size = 17),
axis.title = element_text(size = 20),
axis.text.x = element_text(size = 17, colour = 'black'),
axis.text.y = element_text(size = 17),
plot.title = element_text(size = 25,hjust = -0.17, vjust = 0.27)) +
labs(y = "val µg/g", x = 'Groups')+
annotate("text", x = c(1,2,3,4,5,6), y = 200, label = c("a","a","ab","ab","ab","b"), colour = 'black', size = 7.5)
ggsave('bacctine.pdf',dpi = 600,width = 7, height = 3)
######借鉴后文(正文图先出)######
bk + theme(panel.background = element_rect(fill = "gray100"),
legend.key = element_rect(fill = "gray100"),
legend.background = element_rect(fill = NA),
legend.text = element_text(size = 17),
axis.title = element_text(size = 20),
axis.text.x = element_text(size = 17, colour = 'black'),
axis.text.y = element_text(size = 17),
plot.title = element_text(size = 25,hjust = -0.17, vjust = 0.27)) +
labs(y = "val µg/g", x = 'Groups')+
annotate("text", x = c(1,2,3,4,5,6), y = 150, label = c("a","a","ab","ab","ab","b"), colour = 'black', size = 7.5)
######借鉴后文(正文图先出)######
bk + theme(panel.background = element_rect(fill = "gray100"),
legend.key = element_rect(fill = "gray100"),
legend.background = element_rect(fill = NA),
legend.text = element_text(size = 17),
axis.title = element_text(size = 20),
axis.text.x = element_text(size = 17, colour = 'black'),
axis.text.y = element_text(size = 17),
plot.title = element_text(size = 25,hjust = -0.17, vjust = 0.27)) +
labs(y = "val µg/g", x = 'Groups')+
annotate("text", x = c(1,2,3,4,5,6), y = 120, label = c("a","a","ab","ab","ab","b"), colour = 'black', size = 7.5)
ggsave('bacctine.pdf',dpi = 600,width = 7, height = 3)
#剥离所需数据
p <- hplc[1:30,15:16]
#各组样本数量、含量均值和标准差
attach(p)
table(ids)
aggregate(p$val, by = list(p$ids), FUN = mean)#若报错找不到val，用p$val
aggregate(p$val, by = list(p$ids), FUN = sd)
#检验组间差异ANOVA
fit <- aov(val ~ ids)
#多组Kruskal–Wallis的t检验
kruskal.test(val ~ ids, data = p)
#绘制各组均值及其置信区间的图形
library(gplots)
plotmeans(val ~ ids, xlab = 'ids', ylab = 'val µg/g')
#使用TukeyHSD多重比较（LSD、SSR、Q...?）准确来说是aov再tukey做posthoc
TukeyHSD(fit)
par(las = 1)#标签水平放置，2表示竖直放置
plot(TukeyHSD(fit))
tuk <- glht(fit, linfct = mcp(ids = 'Tukey'))#ids是可变的，与前文ids符合
plot(cld(tuk, level = .05), col = 'lightgrey')
plot(cld(tuk, level = .05), col = 'lightgrey', size=1)
plot(cld(tuk, level = .05), col = 'lightgrey', size=12)
#使用TukeyHSD多重比较（LSD、SSR、Q...?）准确来说是aov再tukey做posthoc
fit = TukeyHSD(fit)
tuk <- glht(fit, linfct = mcp(ids = 'Tukey'))#ids是可变的，与前文ids符合
tuk <- glht(fit, linfct = mcp(tension = 'Tukey'))#ids是可变的，与前文ids符合
#检验组间差异ANOVA
fit <- aov(val ~ ids)
tuk <- glht(fit, linfct = mcp(tension = 'Tukey'))#ids是可变的，与前文ids符合
par(mar = c(5,4,6,2))#增大了顶部面积摆放字母
plot(cld(tuk, level = .05), col = 'lightgrey', axis.text.x = element_text(size = 17, colour = 'black'),
axis.text.y = element_text(size = 17))
plot(cld(tuk, level = .05), col = 'lightgrey', axis.text.x = element_text(size = 17, colour = 'black'),
axis.text.y = element_text(size = 17))+labs(y = "val µg/g", x = 'Groups', size = 20)
plot(cld(tuk, level = .05), col = 'lightgrey', axis.text.x = element_text(size = 17, colour = 'black'),
axis.text.y = element_text(size = 17),labs(y = "val µg/g", x = 'Groups', size = 20))
plot(cld(tuk, level = .05), col = 'lightgrey', axis.text.x = element_text(size = 17, colour = 'black'),
axis.text.y = element_text(size = 17))
plot(cld(tuk, level = .05), col = 'lightgrey', axis.text.x = element_text(size = 10, colour = 'black'),
axis.text.y = element_text(size = 10))
ggsave('PTX.pdf', width = 7,height = 3)
plot(cld(tuk2, level = .05), col = p$ids)
plot(cld(tuk, level = .05), col = p$ids)
#检验组间差异ANOVA
fit <- aov(val ~ ids)
plot(TukeyHSD(fit))
tuk <- glht(fit, linfct = mcp(ids = 'Tukey'))#ids是可变的，与前文ids符合，示例叫tension
plot(cld(tuk, level = .05), col = p$ids)
pdf('PTX.pdf',width = 7, height = 3)
plot(cld(tuk, level = .05), col = p$ids)
dev.off()
pdf('PTX.pdf',width = 4, height = 3)
plot(cld(tuk, level = .05), col = p$ids)
dev.off()
library(UpSetR)
install.packages('UpSetR')
library(UpSetR)
#R 4.0
#提前用Excel把数据处理好，各小组求和，第一列要OTU，格式等尽量排布好
library(readxl)
bac <- read_xlsx('/Users/yanjiacheng/Desktop/毕业数据/OTU信息/细菌抽平后OTU.xlsx', sheet = 3, col_names = T)
bac <- read_xlsx('/Users/yanjiacheng/Desktop/毕业数据/OTU等数据信息/细菌抽平后OTU.xlsx', sheet = 3, col_names = T)
fun <- read_xlsx('/Users/yanjiacheng/Desktop/毕业数据/OTU等数据信息/真菌抽平后OTU.xlsx', sheet = 3, col_names = T)
bac <- as.data.frame(bac)
fun <- as.data.frame(fun)
bac1 <- bac[,2:7]
fun1 <- fun[,2:7]
bac1[bac1>0]=1
fun1[fun1>0]=1
as.data.frame(bac1)
as.data.frame(fun1)
bac2 <- cbind(bac$OTU,bac1)
fun2 <- cbind(fun$OTU,fun1)
upset(bac2,
nsets = 6,
nintersects = 200,
point.size = 2.2, line.size = 0.7, mb.ratio = c(0.5,0.5),
order.by = "degree",
decreasing = TRUE,
matrix.color = "gray23", main.bar.color = "gray23",sets.bar.color = "gray23")
upset(bac2,
nsets = 6,
nintersects = 200,
point.size = 2.2, line.size = 0.7, mb.ratio = c(0.5,0.5),
order.by = "degree",
decreasing = TRUE,
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23")
group = c('tc3','tc5','tc9','wx3','wx5','wx9')
upset(bac2,
nsets = 6,
nintersects = 200,
point.size = 2.2, line.size = 0.7, mb.ratio = c(0.5,0.5),
order.by = "degree",
decreasing = TRUE,
matrix.color = "red", main.bar.color = "blue",sets.bar.color = group)
upset(bac2,
nsets = 6,
nintersects = NA,
point.size = 2.2, line.size = 0.7, mb.ratio = c(0.5,0.5),
order.by = "degree",
decreasing = TRUE,
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23")
upset(bac2,
nsets = 6,
nintersects = NA,
point.size = 2.2, line.size = 0.7, mb.ratio = c(0.5,0.5),
order.by = "degree",
decreasing = TRUE,
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",
set_size.show = T, set_size.numbers_size = 3)
upset(bac2,
nsets = 6,
nintersects = NA,
point.size = 2.2, line.size = 0.7, mb.ratio = c(0.5,0.5),
order.by = "degree",
decreasing = TRUE,
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",
set_size.show = T, set_size.numbers_size = 8)
upset(bac2,
nsets = 6,
nintersects = NA,
point.size = 2.2, line.size = 1.7, mb.ratio = c(0.5,0.5),
order.by = "degree",
decreasing = TRUE,
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",
set_size.show = T, set_size.numbers_size = 8)
0
upset(bac2,
nsets = 6,
nintersects = NA,
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),
order.by = "degree",
decreasing = TRUE,
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",
set_size.show = T, set_size.numbers_size = 8)
pdf('upset.pdf', width = 14.3, height = 14.3)
upset(bac2,
nsets = 6,
nintersects = NA,
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),
order.by = "degree",
decreasing = TRUE,
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",
set_size.show = T, set_size.numbers_size = 8)
upset(fun2,
nsets = 6,
nintersects = NA,
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),
order.by = "degree",
decreasing = TRUE,
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",
set_size.show = T, set_size.numbers_size = 8)
dev.off()
pdf('upsetB.pdf', width = 14.3, height = 14.3)
upset(bac2,
nsets = 6,
nintersects = NA,
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),
order.by = "degree",
decreasing = TRUE,
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",
set_size.show = T, set_size.numbers_size = 8)
dev.off()
pdf('upsetB.pdf', width = 14, height = 7)
upset(bac2,
nsets = 6,
nintersects = NA,
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),
order.by = "degree",
decreasing = TRUE,
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",
set_size.show = T, set_size.numbers_size = 5)
dev.off()
upset(bac2,#数据源
nsets = 6,#6个分组
nintersects = NA,#显示所有交集
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),#点大小、线宽度、图比例
mainbar.y.label = 'OTU numbers',
order.by = "degree", #按程度排序
decreasing = TRUE,#降序
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",#点颜色、棒颜色、图注颜色
set_size.show = T, set_size.numbers_size = 5)#图注数值显示和大小
upset(bac2,#数据源
nsets = 6,#6个分组
nintersects = NA,#显示所有交集
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),#点大小、线宽度、图比例
mainbar.y.label = 'OTU numbers',#y-axis名
order.by = "degree", #按程度排序
decreasing = TRUE,#降序
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",#点颜色、棒颜色、图注颜色
set_size.matrix = 3
set_size.show = T, set_size.numbers_size = 5)#图注数值显示和大小
upset(bac2,#数据源
nsets = 6,#6个分组
nintersects = NA,#显示所有交集
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),#点大小、线宽度、图比例
mainbar.y.label = 'OTU numbers',#y-axis名
order.by = "degree", #按程度排序
decreasing = TRUE,#降序
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",#点颜色、棒颜色、图注颜色
set_size.matrix = 3,
set_size.show = T, set_size.numbers_size = 5)#图注数值显示和大小
upset(bac2,#数据源
nsets = 6,#6个分组
nintersects = NA,#显示所有交集
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),#点大小、线宽度、图比例
mainbar.y.label = 'OTU numbers',#y-axis名
order.by = "degree", #按程度排序
decreasing = TRUE,#降序
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",#点颜色、棒颜色、图注颜色
matrix.size = 3,
set_size.show = T, set_size.numbers_size = 5)#图注数值显示和大小
pdf('upsetB.pdf', width = 14.5, height = 7)
upset(bac2,#数据源
nsets = 6,#6个分组
nintersects = NA,#显示所有交集
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),#点大小、线宽度、图比例
mainbar.y.label = 'OTU numbers',#y-axis名
order.by = "degree", #按程度排序
decreasing = TRUE,#降序
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",#点颜色、棒颜色、图注颜色
set_size.show = T, set_size.numbers_size = 5)#图注数值显示和大小
dev.off()
pdf('upsetB.pdf', width = 15, height = 7)
upset(bac2,#数据源
nsets = 6,#6个分组
nintersects = NA,#显示所有交集
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),#点大小、线宽度、图比例
mainbar.y.label = 'OTU numbers',#y-axis名
order.by = "degree", #按程度排序
decreasing = TRUE,#降序
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",#点颜色、棒颜色、图注颜色
set_size.show = T, set_size.numbers_size = 8)#图注数值显示和大小
dev.off()
pdf('upsetB.pdf', width = 16, height = 7)
upset(bac2,#数据源
nsets = 6,#6个分组
nintersects = NA,#显示所有交集
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),#点大小、线宽度、图比例
mainbar.y.label = 'OTU numbers',#y-axis名
order.by = "degree", #按程度排序
decreasing = TRUE,#降序
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",#点颜色、棒颜色、图注颜色
set_size.show = T, set_size.numbers_size = 8)#图注数值显示和大小
dev.off()
pdf('upsetB.pdf', width = 19, height = 7)
upset(bac2,#数据源
nsets = 6,#6个分组
nintersects = NA,#显示所有交集
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),#点大小、线宽度、图比例
mainbar.y.label = 'OTU numbers',#y-axis名
order.by = "degree", #按程度排序
decreasing = TRUE,#降序
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",#点颜色、棒颜色、图注颜色
set_size.show = T, set_size.numbers_size = 8)#图注数值显示和大小
dev.off()
pdf('upsetB.pdf', width = 14, height = 7)
upset(bac2,#数据源
nsets = 6,#6个分组
nintersects = NA,#显示所有交集
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),#点大小、线宽度、图比例
mainbar.y.label = 'OTU numbers',#y-axis名
order.by = "degree", #按程度排序
decreasing = TRUE,#降序
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",#点颜色、棒颜色、图注颜色
set_size.show = T, set_size.numbers_size = 8)#图注数值显示和大小
dev.off()
pdf('upsetF.pdf', width = 15, height = 7)
upset(fun2,
nsets = 6,
nintersects = NA,
point.size = 2.0, line.size = 0.6, mb.ratio = c(0.5,0.5),
mainbar.y.label = 'OTU numbers',
order.by = "degree",
decreasing = TRUE,
matrix.color = "red", main.bar.color = "blue",sets.bar.color = "gray23",
set_size.show = T, set_size.numbers_size = 8)
dev.off()
